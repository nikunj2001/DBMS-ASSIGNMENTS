CREATE TABLE College (
    collegeName VARCHAR(10) PRIMARY KEY,
    state VARCHAR(10),
    enrollment INTEGER
);

CREATE TABLE Student (
    sID INTEGER PRIMARY KEY,
    sName VARCHAR(10),
    GPA FLOAT,
    sizeHS INTEGER
);

CREATE TABLE Apply (
    sID INTEGER,
    cName VARCHAR(10),
    major VARCHAR(20),
    decision CHAR(1),
    PRIMARY KEY (sID , cName , major),
    CONSTRAINT sID_fk FOREIGN KEY (sID)
        REFERENCES Student(sID),
    CONSTRAINT cName_fk FOREIGN KEY (cName)
        REFERENCES College(collegeName)
);

INSERT INTO Student VALUES (123, 'Amy', 3.9, 1000);
INSERT INTO Student VALUES (234, 'Bob', 3.6, 1500);
INSERT INTO Student VALUES (345, 'Craig', 3.5, 500);
INSERT INTO Student VALUES (456, 'Doris', 3.9, 1000);
INSERT INTO Student VALUES (567, 'Edward', 2.9, 2000);
INSERT INTO Student VALUES (678, 'Fay', 3.8, 200);
INSERT INTO Student VALUES (789, 'Gary', 3.4, 800);
INSERT INTO Student VALUES (987, 'Helen', 3.7, 800);
INSERT INTO Student VALUES (876, 'Irene', 3.9, 400);
INSERT INTO Student VALUES (765, 'Jay', 2.9, 1500);
INSERT INTO Student VALUES (654, 'Amy', 3.9, 1000);
INSERT INTO Student VALUES (543, 'Craig', 3.4, 2000);

INSERT INTO College VALUES ('Stanford', 'CA', 15000);
INSERT INTO College VALUES ('Berkeley', 'CA', 36000);
INSERT INTO College VALUES ('MIT', 'MA', 10000);
INSERT INTO College VALUES ('Cornell', 'NY', 21000);
INSERT INTO College VALUES ('Harvard', 'MA', 50040);

INSERT INTO Apply VALUES (123, 'Stanford', 'CS', 'Y');
INSERT INTO Apply VALUES (123, 'Stanford', 'EE', 'N');
INSERT INTO Apply VALUES (123, 'Berkeley', 'CS', 'Y');
INSERT INTO Apply VALUES (123, 'Cornell', 'EE', 'Y');
INSERT INTO Apply VALUES (234, 'Berkeley', 'biology', 'N');
INSERT INTO Apply VALUES (345, 'MIT', 'bioengineering', 'Y');
INSERT INTO Apply VALUES (345, 'Cornell', 'bioengineering', 'N');
INSERT INTO Apply VALUES (345, 'Cornell', 'CS', 'Y');
INSERT INTO Apply VALUES (345, 'Cornell', 'EE', 'N');
INSERT INTO Apply VALUES (678, 'Stanford', 'history', 'Y');
INSERT INTO Apply VALUES (987, 'Stanford', 'CS', 'Y');
INSERT INTO Apply VALUES (987, 'Berkeley', 'CS', 'Y');
INSERT INTO Apply VALUES (876, 'Stanford', 'CS', 'N');
INSERT INTO Apply VALUES (876, 'MIT', 'biology', 'Y');
INSERT INTO Apply VALUES (876, 'MIT', 'marine biology', 'N');
INSERT INTO Apply VALUES (765, 'Stanford', 'history', 'Y');
INSERT INTO Apply VALUES (765, 'Cornell', 'history', 'N');
INSERT INTO Apply VALUES (765, 'Cornell', 'psychology', 'Y');
INSERT INTO Apply VALUES (543, 'MIT', 'CS', 'N');



-- QUERY-1
SELECT * FROM STUDENT INNER JOIN APPLY ON STUDENT.sID=APPLY.sID


-- QUERY-2
SELECT STUDENT.sID,STUDENT.sName,STUDENT.GPA,APPLY.cName,APPLY.major FROM STUDENT INNER JOIN 
APPLY ON STUDENT.sID=APPLY.sID


-- QUERY-3

SELECT APPLY.sID,APPLY.cName,APPLY.major,APPLY.decision FROM APPLY INNER JOIN COLLEGE ON APPLY.cName=COLLEGE.collegeName
WHERE COLLEGE.state='CA'

-- QUERY-4

SELECT STUDENT.sID,STUDENT.sName,STUDENT.GPA,APPLY.cName FROM STUDENT INNER JOIN APPLY ON 
STUDENT.sID=APPLY.sID WHERE (APPLY.cName='Stanford' AND GPA>3.7)

-- QUERY-5
SELECT STUDENT.sID,STUDENT.sName,STUDENT.GPA,STUDENT.sizeHS FROM STUDENT INNER JOIN APPLY ON 
STUDENT.sID=APPLY.sID
WHERE APPLY.major='CS' AND APPLY.decision='N';

-- QUERY-6
SELECT STUDENT.sID,STUDENT.sNAME,STUDENT.GPA,STUDENT.sizeHS,
            APPLY.cName,APPLY.major,APPLY.decision FROM STUDENT
            INNER JOIN APPLY ON STUDENT.sID=APPLY.sID
            INNER JOIN COLLEGE ON APPLY.cName=COLLEGE.collegeName
            WHERE COLLEGE.state='NY';
            
-- QUERY-7            
            
SELECT * FROM STUDENT WHERE(STUDENT.sID NOT IN (SELECT DISTINCT sID FROM APPLY ))
           
-- QUERY-8           
            
SELECT * FROM COLLEGE WHERE(COLLEGE.collegeName NOT IN (SELECT DISTINCT cName FROM APPLY))


-- QUERY-9


SELECT sID FROM APPLY GROUP BY sID HAVING COUNT(sID)=1;

-- QUERY-10

SELECT STUDENT.sName,STUDENT.GPA FROM STUDENT INNER JOIN APPLY ON STUDENT.sID = APPLY.sID
    INNER JOIN COLLEGE ON APPLY.cName=COLLEGE.collegeName  
    WHERE COLLEGE.enrollment<=25000

-- QUERY-11

SELECT sID1, sID2 FROM (SELECT STUDENT1.sID AS sID1, STUDENT2.sID AS sID2 FROM STUDENT AS STUDENT1
    INNER JOIN STUDENT AS STUDENT2 ON STUDENT1.GPA = STUDENT2.GPA
    WHERE
        STUDENT1.sID != STUDENT2.sID) AS T
WHERE sID1 < sID2
ORDER BY sID1;

-- QUERY-12

SELECT STUDENT.sNAME,APPLY.major FROM STUDENT CROSS JOIN APPLY 
WHERE STUDENT.sID=APPLY.sID

SELECT STUDENT.sName,APPLY.major FROM STUDENT NATURAL JOIN APPLY

SELECT STUDENT.sName,APPLY.major FROM STUDENT INNER JOIN APPLY ON STUDENT.sID=APPLY.sID

-- QUERY-13

SELECT STUDENT.sID,STUDENT.sName,STUDENT.GPA,STUDENT.sizeHS FROM STUDENT CROSS JOIN APPLY
    WHERE STUDENT.sID=APPLY.sID AND 
    APPLY.major='CS' AND
    STUDENT.sizeHS<20000 AND 
    APPLY.cName='Stanford';
    
    
SELECT STUDENT.sID,STUDENT.sName,STUDENT.GPA,STUDENT.sizeHS FROM STUDENT NATURAL JOIN APPLY WHERE
    STUDENT.sizeHS<20000 AND
    APPLY.major='CS' AND
    APPLY.cName='Stanford'
    
SELECT STUDENT.sID,STUDENT.sName,STUDENT.GPA,STUDENT.sizeHS FROM STUDENT INNER JOIN APPLY ON STUDENT.sID=APPLY.sID
WHERE
    STUDENT.sizeHS<20000 AND
    APPLY.major='CS' AND
    APPLY.cName='Stanford'

-- QUERY-14
    
SELECT * FROM STUDENT CROSS JOIN APPLY CROSS JOIN COLLEGE
    WHERE STUDENT.sID=APPLY.sID AND
        APPLY.cName=COLLEGE.collegeName
        
SELECT * FROM STUDENT NATURAL JOIN APPLY INNER JOIN COLLEGE 
    ON APPLY.cName = COLLEGE.collegeName

SELECT * FROM STUDENT INNER JOIN APPLY ON STUDENT.sID=APPLY.sID 
    INNER JOIN COLLEGE ON APPLY.cName=COLLEGE.collegeName 

-- QUERY-15
    
SELECT STUDENT.sName,STUDENT.GPA FROM STUDENT CROSS JOIN APPLY WHERE 
    STUDENT.sID=APPLY.sID AND 
    STUDENT.sizeHS>1000 AND 
    APPLY.major='CS' AND 
    APPLY.decision='N'
    
SELECT STUDENT.SNAME , STUDENT.GPA FROM STUDENT NATURAL JOIN APPLY WHERE 
    STUDENT.SIZEHS>1000 AND 
    APPLY.MAJOR='CS' AND 
    APPLY.DECISION='N'
    
SELECT STUDENT.SNAME,STUDENT.GPA FROM STUDENT INNER JOIN APPLY ON STUDENT.SID=APPLY.SID
WHERE  STUDENT.SIZEHS>1000 AND 
    APPLY.MAJOR='CS' AND 
    APPLY.DECISION='N'
    
    
-- QUERY-16    
    
SELECT STUDENT.SNAME,STUDENT.GPA FROM STUDENT CROSS JOIN APPLY CROSS JOIN COLLEGE
    WHERE STUDENT.SID=APPLY.SID AND 
    APPLY.CNAME=COLLEGE.COLLEGENAME AND 
    STUDENT.SIZEHS>1000 AND 
    APPLY.MAJOR='CS' AND 
    COLLEGE.ENROLLMENT>20000 AND 
    APPLY.DECISION='N'
    
SELECT STUDENT.SNAME ,STUDENT.GPA FROM STUDENT NATURAL JOIN APPLY INNER JOIN 
    COLLEGE ON APPLY.CNAME=COLLEGE.COLLEGENAME 
    WHERE
    STUDENT.SIZEHS>1000 AND 
    APPLY.MAJOR='CS' AND 
    COLLEGE.ENROLLMENT>20000 AND 
    APPLY.DECISION='N'

SELECT STUDENT.SNAME,STUDENT.GPA FROM STUDENT INNER JOIN APPLY ON STUDENT.SID=APPLY.SID 
    INNER JOIN COLLEGE ON APPLY.CNAME=COLLEGE.COLLEGENAME
        WHERE
    STUDENT.SIZEHS>1000 AND 
    APPLY.MAJOR='CS' AND 
    COLLEGE.ENROLLMENT>20000 AND 
    APPLY.DECISION='N'
